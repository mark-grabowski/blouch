"0","optima_matrix<-weight.matrix(trdata$phy, a, lineages) #Slouch approach"
"0","pred_X<-calc_adaptive_dmX(a,T_term,X)"
"0","#optima<-c(2,1.5,1,0.5)"
"0","optima<-c(1,2,3,4)"
"0","beta<-c(0.75,0.5,0.35,0.25) #Two Optima/Two Slopes"
"0","#beta<-c(0.25,0.15,0.35,0.1) #Two Optima/Two Slopes"
"0",""
"0","#beta<-data.frame(matrix(c(0.25,0.15,0.35,0.1),ncol=2,nrow=2)) #Two traits on columns, two regimes on vertical"
"0",""
"0","mu<-matrix(NA,N,1)"
"0","for(i in 1:N){"
"0","  mu[i] = optima_matrix[i,]%*%optima+beta[reg_tips[i]]%*%pred_X[i]"
"0","  #mu[i] = optima_matrix[i,]%*%optima+pred_X[i,]%*%t(beta[reg_tips[i],])"
"0","  "
"0","}"
"0",""
"0","n_reg<-length(unique(regimes))"
"0","V<-calc_adaptive_V(phy,a, sigma2_y, ta,  tij,  tja,  T_term,  beta,  sigma2_x, Z_adaptive, n_reg)"
"0","Y<-MASS::mvrnorm(n=1,mu,V)"
"0",""
